(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[901],{2682:function(e,n,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/coroutine-context/what-is-coroutine-context",function(){return s(4016)}])},4016:function(e,n,s){"use strict";s.r(n),s.d(n,{__toc:function(){return a},default:function(){return d}});var o=s(5893),r=s(2673),i=s(373),l=s(8426);s(9128);var c=s(2643),t={src:"/docs-kotlin-coroutine/_next/static/media/async.332c3472.png",height:500,width:872,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAFCAIAAAD38zoCAAAAeklEQVR42gXA2A6CIL6h9dRpXF2WAikyRaEDQtf3lMyPb0DsE9PJZ/Dh0wev27uWlT6eMmBsFicbvyyO6jfqONXes/mMAsW5db1pquFRO10WZUERXqy2QNykfQ2NfavOS+0ueZsTtNxAwNOUMXG+cggRoQeI6TrBO0j+U6EbFrJLM7cAAAAASUVORK5CYII=",blurWidth:8,blurHeight:5};let a=[{depth:2,value:"CoroutineContext",id:"coroutinecontext"},{depth:2,value:"ThreadLocal",id:"threadlocal"},{depth:2,value:"suspend 함수 내에서 CoroutineContext 를 어떻게 접근하나요?",id:"suspend-함수-내에서-coroutinecontext-를-어떻게-접근하나요"},{depth:2,value:"async, launch 등의 코루틴 빌더는 왜 {} 으로 끝나나요?",id:"async-launch-등의-코루틴-빌더는-왜--으로-끝나나요"}];function _createMdxContent(e){let n=Object.assign({h2:"h2",p:"p",br:"br",code:"code",pre:"pre",span:"span",ul:"ul",li:"li",img:"img"},(0,c.a)(),e.components);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h2,{id:"coroutinecontext",children:"CoroutineContext"}),"\n",(0,o.jsxs)(n.p,{children:["자바에서는 Thread 에서 공유할 데이터를 ThreadLocal 을 통해 공유합니다. 하지만 suspend 함수에서 코루틴 기반의 연산을 할 경우에는 이것이 불가능합니다. 코틀린에서는 코틀린의 코루틴에서 사용되는 하나의 데이터 문맥을 CoroutineContext 라고 부릅니다.",(0,o.jsx)(n.br,{})]}),"\n",(0,o.jsxs)(n.p,{children:["그리고 이 CoroutineContext 는 Java 의 ThreadLocal 처럼 전역적으로 공유하는 것이 아니라 어떤 코루틴에서 생성했는지 여부 등에 따라서 지역적인 특성을 가집니다. ",(0,o.jsx)(n.br,{})]}),"\n",(0,o.jsxs)(n.p,{children:["개인적으로는 코틀린의 코루틴을 처음 접할 때 이런 점이 Java 보다는 더 매력적으로 느껴졌던 것 같습니다. ",(0,o.jsx)(n.br,{})]}),"\n",(0,o.jsxs)(n.p,{children:["코루틴 컨텍스트는 서로 더해서 합칠수도 있고, 코루틴 컨텍스트 내에서 특정 코루틴 컨텍스트를 삭제한는 것도 가능합니다. 그리고 map 의 get 연산처럼 특정 코루틴 컨텍스트 타입을 통해서 그 코루틴 컨텍스트를 조회해서 가져오는 것 역시 가능합니다.",(0,o.jsx)(n.br,{})]}),"\n",(0,o.jsxs)(n.p,{children:["Java 의 ThreadLocal 보다 훨씬 많은 연산을 제공하기도 하고, 코루틴 컨텍스트를 트리 구조를 통해서 관리할 수 도 있으며 코루틴 컨텍스트 간 병합/삭제 역시 가능하다는 점은 코루틴 컨텍스트를 다루는 데에 있어서 유연함을 제공합니다. 이렇게 여러 연산을 수행하고 병합/삭제 기능 등에 대한 설명은 이번 문서 이후의 다른 문서에 정리해두었습니다.",(0,o.jsx)(n.br,{})]}),"\n",(0,o.jsx)(n.br,{}),"\n",(0,o.jsx)(n.h2,{id:"threadlocal",children:"ThreadLocal"}),"\n",(0,o.jsxs)(n.p,{children:["Kotlin 의 코루틴은 ",(0,o.jsx)(n.code,{children:"runBlocking"})," 을 사용할 경우를 제외하고는  Java 의 ThreadLocal 을 이용해 스레드 레벨에서의 Context 공유는 불가능합니다. 대신 ThreadLocal 을 CoroutineContext 를 통해 표현한 코틀린 버전의 ThreadLocalElement 라는 CoroutineContext 객체가 있기는 합니다.",(0,o.jsx)(n.br,{})]}),"\n",(0,o.jsx)(n.p,{children:"e.g."}),"\n",(0,o.jsx)(n.pre,{"data-language":"kotlin","data-theme":"default",children:(0,o.jsxs)(n.code,{"data-language":"kotlin","data-theme":"default",children:[(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"package"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" io.chagchagchag.demo.kotlin_coroutine.coroutine_context"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" io.chagchagchag.demo.kotlin_coroutine.helper.logger"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" kotlinx.coroutines.Dispatchers"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" kotlinx.coroutines.launch"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" kotlinx.coroutines.runBlocking"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:" "}),"\n",(0,o.jsx)(n.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"fun"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"main"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(){"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"val"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" log "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"logger"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"()"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "})}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"val"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" isGreen "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"ThreadLocal"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"<"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"String"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:">()"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  isGreen."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"set"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Yes"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"runBlocking"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 1)"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    log."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"info"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"현재 스레드 = {}"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:", Thread."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"currentThread"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"().name)"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    log."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"info"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"isGreen == {}"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:", isGreen."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"())"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"assert"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(isGreen."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"() "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"!="}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"null"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 2)"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"launch"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" (Dispatchers.IO){"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      log."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"info"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"현재 스레드 = {}"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:", Thread."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"currentThread"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"().name)"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      log."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"info"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"isGreen = {}"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:", isGreen."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"())"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"      "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"assert"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(isGreen."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"get"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"() "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=="}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"null"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "})}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,o.jsx)(n.br,{}),"\n",(0,o.jsx)(n.p,{children:"출력결과"}),"\n",(0,o.jsx)(n.pre,{"data-language":"plain","data-theme":"default",children:(0,o.jsxs)(n.code,{"data-language":"plain","data-theme":"default",children:[(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"20:34:55.017 [main] INFO io.chagchagchag.demo.kotlin_coroutine.helper.LoggerDump -- 현재 스레드 = main"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"20:34:55.021 [main] INFO io.chagchagchag.demo.kotlin_coroutine.helper.LoggerDump -- isGreen == Yes"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"20:34:55.037 [DefaultDispatcher-worker-1] INFO io.chagchagchag.demo.kotlin_coroutine.helper.LoggerDump -- 현재 스레드 = DefaultDispatcher-worker-1"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"20:34:55.038 [DefaultDispatcher-worker-1] INFO io.chagchagchag.demo.kotlin_coroutine.helper.LoggerDump -- isGreen = null"})})]})}),"\n",(0,o.jsx)(n.br,{}),"\n",(0,o.jsxs)(n.p,{children:["1) 과 2) 에서 각각 사용된 스레드가 다르다는 것을 확인 가능합니다.",(0,o.jsx)(n.br,{})]}),"\n",(0,o.jsx)(n.p,{children:"1)"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"1) 에서 호출한 결과는 ThreadLocal 의 변수를 제대로 가져옵니다."}),"\n",(0,o.jsx)(n.li,{children:"그리고 현재 스레드의 이름을 출력해본 결과 main 으로 나타납니다."}),"\n",(0,o.jsx)(n.li,{children:"runBlocking 이라는 코루틴 빌더는 main 스레드에서 실행되기 때문에 ThreadLocal 을 사용가능하고, main 스레드에서 실행할 수 있습니다."}),"\n",(0,o.jsx)(n.li,{children:"하지만 블로킹 방식이라는 점에 주의해야 합니다."}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"2)"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"2) 에서 호출한 결과는 main 클래스에서 선언한 ThreadLocal 변수의 값을 가져오지 못합니다."}),"\n",(0,o.jsx)(n.li,{children:"main 스레드에서 실행되는 것이 아니기 때문입니다."}),"\n",(0,o.jsx)(n.li,{children:"launch, async 같은 suspend 함수들은 main 스레드에서 실행되지 않고 코루틴에서 실행됩니다."}),"\n",(0,o.jsx)(n.li,{children:"코루틴은 내부적으로 다른 스레드에서 실행되고 코루틴 자신이 실행될 스레드 역시 CoroutineDispatcher 에 의해 바뀔 때도 있습니다. 따라서 ThreadLocal 변수를 공유하는 것이 불가능에 가깝습니다."}),"\n"]}),"\n",(0,o.jsx)(n.br,{}),"\n",(0,o.jsx)(n.h2,{id:"suspend-함수-내에서-coroutinecontext-를-어떻게-접근하나요",children:"suspend 함수 내에서 CoroutineContext 를 어떻게 접근하나요?"}),"\n",(0,o.jsxs)(n.p,{children:["suspend 키워드가 적용된 함수 내에서는 ",(0,o.jsx)(n.code,{children:"coroutineContext"})," 라는 변수에 접근 가능합니다.",(0,o.jsx)(n.br,{})]}),"\n",(0,o.jsx)(n.pre,{"data-language":"kotlin","data-theme":"default",children:(0,o.jsxs)(n.code,{"data-language":"kotlin","data-theme":"default",children:[(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"package"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" io.chagchagchag.demo.kotlin_coroutine.coroutine_context"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" io.chagchagchag.demo.kotlin_coroutine.helper.logger"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" kotlinx.coroutines.runBlocking"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" kotlin.coroutines.coroutineContext"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" kotlin.coroutines.resume"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" kotlin.coroutines.suspendCoroutine"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"fun"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"main"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(){"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"val"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" log "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"logger"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"()"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "})}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// (1)"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"runBlocking"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    log."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"info"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"현재 코루틴 스코프 내의 코루틴 컨텍스트 : '}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"this"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:".coroutineContext"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"inner"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"() "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 다른 함수를 호출할 때 어떻게 되는지 확인해봅니다."})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"private"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"suspend"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"fun"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"inner"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(){"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"val"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" log "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"logger"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"()"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// (2)"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  log."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"info"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"suspend 함수 내에서의 context '}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"coroutineContext"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:" "}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// (3)"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"var"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" result "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"suspendCoroutine"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"<"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"String"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"> { continuation "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"->"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    log."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"info"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Continuation 객체 내의 context = '}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"${"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"continuation.context"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"}"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    continuation."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"resume"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"OK"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  }"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "})}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// (4)"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"  log."}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"info"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"inner 함수 내애서의 result = $result"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,o.jsx)(n.p,{children:"(1)"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["(1) 에서는 ",(0,o.jsx)(n.code,{children:"runBlocking{...}"})," 함수 내에서 코루틴 컨텍스트에 접근하는데, ",(0,o.jsx)(n.code,{children:"coroutineContext"})," 변수로 접근했다는 것을 알 수 있습니다. runBlocking 함수의 마지막 인자는 람다인데, 이 람다 내에서 coroutineContext 필드를 접근하고 있는 것을 알 수 있습니다."]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"(2)"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["(2) 에서는 일반 suspend 함수에서 coroutineContext 에 접근하는 것을 보여줍니다. suspend 함수 내에서는 단순히 ",(0,o.jsx)(n.code,{children:"coroutineContext"})," 필드를 사용해서 코루틴 컨텍스트데 접근 가능합니다."]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"(3)"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["(3) 에서는 ",(0,o.jsx)(n.code,{children:"suspendCoroutine"})," 함수를 실행하고 있는데, ",(0,o.jsx)(n.code,{children:"suspendCoroutine"})," 함수의 마지막인자인 람다를 이용하고 있습니다. 이 람다의 첫번째 인자는 ",(0,o.jsx)(n.code,{children:"continuation"})," 타입인데, 이 continuation 타입 내의 ",(0,o.jsx)(n.code,{children:"context"})," 필드를 통해서 CoroutineContext 필드에 접근이 가능합니다."]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"(4)"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"suspendCoroutine 이 반환한 result 값을 받아서 확인해보니 정상적으로 돌려받았습니다. suspend 함수를 동기연산처럼 사용했습니다."}),"\n"]}),"\n",(0,o.jsx)(n.br,{}),"\n",(0,o.jsx)(n.p,{children:"위의 코드에 대한 출력결과는 아래와 같습니다."}),"\n",(0,o.jsx)(n.pre,{"data-language":"plain","data-theme":"default",children:(0,o.jsxs)(n.code,{"data-language":"plain","data-theme":"default",children:[(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"21:37:30.203 [main] INFO io.chagchagchag.demo.kotlin_coroutine.helper.LoggingObject -- 현재 코루틴 스코프 내의 코루틴 컨텍스트 : [BlockingCoroutine{Active}@5ec0a365, BlockingEventLoop@4fe3c938]"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"21:37:30.210 [main] INFO io.chagchagchag.demo.kotlin_coroutine.helper.LoggingObject -- suspend 함수 내에서의 context [BlockingCoroutine{Active}@5ec0a365, BlockingEventLoop@4fe3c938]"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"21:37:30.213 [main] INFO io.chagchagchag.demo.kotlin_coroutine.helper.LoggingObject -- Continuation 객체 내의 context = [BlockingCoroutine{Active}@5ec0a365, BlockingEventLoop@4fe3c938]"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"21:37:30.213 [main] INFO io.chagchagchag.demo.kotlin_coroutine.helper.LoggingObject -- inner 함수 내애서의 result = OK"})})]})}),"\n",(0,o.jsx)(n.br,{}),"\n",(0,o.jsxs)(n.h2,{id:"async-launch-등의-코루틴-빌더는-왜--으로-끝나나요",children:["async, launch 등의 코루틴 빌더는 왜 ",(0,o.jsx)(n.code,{children:"{}"})," 으로 끝나나요?"]}),"\n",(0,o.jsxs)(n.p,{children:["async 함수를 예로 들어보겠습니다. ",(0,o.jsx)(n.code,{children:"kotlin-coroutines-core"})," 라이브러리에서 제공하는  ",(0,o.jsx)(n.code,{children:"Builders.common.kt"})," 파일 내의 async 함수는 아래와 같이 정의되어 있습니다."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{placeholder:"blur",src:t})}),"\n",(0,o.jsxs)(n.p,{children:["마지막 인자는 ",(0,o.jsx)(n.code,{children:"suspend CoroutineScope.() -> T"})," 와 같이 선언되어 람다로 선언되어 있음을 확인 가능합니다.",(0,o.jsx)(n.br,{})]}),"\n",(0,o.jsxs)(n.p,{children:["코틀린 문법을 정리하면서 자세히 정리하겠지만, 코틀린에서는 함수의 마지막인자가 람다일 경우 ",(0,o.jsx)(n.code,{children:"()"})," 으로 감싸지 않고 ",(0,o.jsx)(n.code,{children:"{ }"})," 으로 끝낼 수 있습니다. 위의 코드에서는 세개의 인자들 중 context, start 는 모두 디폴트 값이 정해져 있고, 마지막 인자는 람다입니다. 따라서 async (...) 함수를 호출할 때에는  아래와 같은 식으로 표현하는 것이 가능해집니다."]}),"\n",(0,o.jsx)(n.pre,{"data-language":"kotlin","data-theme":"default",children:(0,o.jsxs)(n.code,{"data-language":"kotlin","data-theme":"default",children:[(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"fun"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"main"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"(){"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"async"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"{ "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// 여기부터 있는 람다 바디는 사실 async() 함수의 마지막 인자에요!!"})]}),"\n",(0,o.jsxs)(n.span,{className:"line",children:[(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"        "}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"println"}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"("}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"안뇽하세요"'}),(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:")"})]}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,o.jsx)(n.span,{className:"line",children:(0,o.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,o.jsx)(n.br,{}),"\n",(0,o.jsxs)(n.p,{children:["그리고 ",(0,o.jsx)(n.code,{children:"kotlin-coroutine-core"})," 에서 제공하는 async, launch, withContext 등과 같은 코루틴과 관련된 함수들을 코루틴 빌더라고 부릅니다.",(0,o.jsx)(n.br,{})]}),"\n",(0,o.jsx)(n.br,{})]})}let h={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,c.a)(),e.components);return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(_createMdxContent,{...e})}):_createMdxContent(e)},pageOpts:{filePath:"pages/coroutine-context/what-is-coroutine-context.md",route:"/coroutine-context/what-is-coroutine-context",timestamp:1710618009e3,pageMap:[{kind:"Folder",name:"channel",route:"/channel",children:[{kind:"MdxPage",name:"intro",route:"/channel/intro"},{kind:"Meta",data:{intro:"Intro"}}]},{kind:"Folder",name:"coroutine-context",route:"/coroutine-context",children:[{kind:"MdxPage",name:"coroutine-context-types-features-and-uml",route:"/coroutine-context/coroutine-context-types-features-and-uml"},{kind:"MdxPage",name:"coroutine-exception-handler",route:"/coroutine-context/coroutine-exception-handler"},{kind:"MdxPage",name:"intro",route:"/coroutine-context/intro"},{kind:"MdxPage",name:"what-is-coroutine-context",route:"/coroutine-context/what-is-coroutine-context"},{kind:"Meta",data:{intro:"Intro","what-is-coroutine-context":"CoroutineContext","coroutine-context-types-features-and-uml":"CoroutineContext 의 종류, 특징, UML","coroutine-exception-handler":"CoroutineExceptionHandler"}}]},{kind:"Folder",name:"coroutine-dispatcher",route:"/coroutine-dispatcher",children:[{kind:"MdxPage",name:"intro",route:"/coroutine-dispatcher/intro"},{kind:"MdxPage",name:"what-is-coroutine-dispatcher",route:"/coroutine-dispatcher/what-is-coroutine-dispatcher"},{kind:"Meta",data:{"what-is-coroutine-dispatcher":"CoroutineDispatcer",intro:"Intro"}}]},{kind:"Folder",name:"coroutine-scope-and-structured-concurrency",route:"/coroutine-scope-and-structured-concurrency",children:[{kind:"MdxPage",name:"coroutine",route:"/coroutine-scope-and-structured-concurrency/coroutine"},{kind:"MdxPage",name:"intro",route:"/coroutine-scope-and-structured-concurrency/intro"},{kind:"MdxPage",name:"what-is-coroutine-scope",route:"/coroutine-scope-and-structured-concurrency/what-is-coroutine-scope"},{kind:"Meta",data:{intro:"Intro","what-is-coroutine-scope":"CoroutineScope",coroutine:"Coroutine"}}]},{kind:"Folder",name:"coroutine-useful-case",route:"/coroutine-useful-case",children:[{kind:"MdxPage",name:"intro",route:"/coroutine-useful-case/intro"},{kind:"Meta",data:{intro:"Intro"}}]},{kind:"Folder",name:"flow",route:"/flow",children:[{kind:"MdxPage",name:"intro",route:"/flow/intro"},{kind:"Meta",data:{intro:"Intro"}}]},{kind:"MdxPage",name:"index",route:"/"},{kind:"Folder",name:"kotlin-basic",route:"/kotlin-basic",children:[{kind:"MdxPage",name:"intro",route:"/kotlin-basic/intro"},{kind:"Meta",data:{intro:"Intro"}}]},{kind:"Folder",name:"suspend-and-fsm-cps",route:"/suspend-and-fsm-cps",children:[{kind:"MdxPage",name:"fsm-and-cps",route:"/suspend-and-fsm-cps/fsm-and-cps"},{kind:"MdxPage",name:"to-coroutine",route:"/suspend-and-fsm-cps/to-coroutine"},{kind:"MdxPage",name:"what-is-suspend-function",route:"/suspend-and-fsm-cps/what-is-suspend-function"},{kind:"Meta",data:{"what-is-suspend-function":"suspend 함수","fsm-and-cps":"FSM, CPS","to-coroutine":"코루틴 코드로 바꿔보면"}}]},{kind:"Meta",data:{index:"Introduction","coroutine-useful-case":"코루틴 사용이 더 나은 경우들","suspend-and-fsm-cps":"suspend 함수와 FSM,CPS","coroutine-context":"CoroutineContext","coroutine-dispatcher":"CoroutineDispatcher","coroutine-scope-and-structured-concurrency":"CoroutineScope, Structured Concurrency",flow:"Flow",channel:"Channel","kotlin-basic":"코틀린 기초",contact:{title:"Contact ↗",type:"page",href:"-",newWindow:!0}}}],flexsearch:{codeblocks:!0},title:"What Is Coroutine Context",headings:a},pageNextRoute:"/coroutine-context/what-is-coroutine-context",nextraLayout:i.ZP,themeConfig:l.Z};var d=(0,r.j)(h)},8426:function(e,n,s){"use strict";var o=s(5893);s(7294);let r={logo:(0,o.jsx)("span",{children:"Docs Kotlin Coroutine"}),project:{link:"https://github.com/chagchagchag/docs-kotlin-coroutine"},docsRepositoryBase:"https://github.com/chagchagchag/docs-kotlin-coroutine",footer:{text:"Nextra Docs Template"}};n.Z=r},5789:function(){}},function(e){e.O(0,[774,796,888,179],function(){return e(e.s=2682)}),_N_E=e.O()}]);